<MudTooltip Text="Add Theme" Color="Color.Dark">
    <MudPaper Class="d-flex flex-grow-1 align-center pl-2" Outlined="true" @onclick="ToggleOpen" >
        <MudText Typo="Typo.caption">Add Theme</MudText>
        <MudSpacer/>
        <MudDivider Vertical="true" FlexItem="true" />
        <MudIconButton Ripple="false" Icon="@Icons.Material.Sharp.KeyboardArrowRight" Size="Size.Small"/>
    </MudPaper>
</MudTooltip>

<MudPopover Open="@_open" Fixed="true" Class="pa-2">
    <MudStack Spacing="2">
        <MudStack Row="true" AlignItems="AlignItems.Center" Justify="Justify.SpaceBetween" >
            <MudText Class="justify-start" Typo="Typo.caption">Add Theme</MudText>
            <MudIconButton Variant="Variant.Filled" Icon="@Icons.Material.Filled.Refresh" Size="Size.Small"/>
        </MudStack>
        @if (!string.IsNullOrEmpty(SelectedTheme))
        {
            <MudChip T="string" OnClose="Closed" Size="Size.Small" CloseIcon="@Icons.Material.Filled.Close" >
                <MudText Typo="Typo.caption" Color="Color.Primary">@SelectedTheme</MudText> 
            </MudChip>
        }
        <MudSelect T="string"
                   @bind-Value="SelectedTheme"
                   Variant="Variant.Outlined"
                   Margin="Margin.Dense"
                   OpenIcon=""
                   CloseIcon="false"
                   Placeholder="Enter theme"
                   Underline="false">
            @foreach (var theme in _themes)
            {
                <MudSelectItem Value="theme">@theme</MudSelectItem>
            }
        </MudSelect>        <MudStack Class="mt-3" Row="true" Justify="Justify.FlexEnd">
            <MudButton Variant="Variant.Filled" Color="Color.Error" Size="Size.Small" OnClick="ToggleOpen">OK</MudButton>
        </MudStack>
    </MudStack>
</MudPopover>

@code{
    private bool _open;
    private bool _isVisible;

    private void ToggleOpen() => _open = !_open;
    
    
    private string? SelectedTheme { get; set; }

    void Closed(MudChip<string> chip) {
        SelectedTheme = null; 
    }

    private readonly string[] _themes =
    {
        "Endorsement", "Enjoyment", "Holiday", "Lifestyle", "Sustainability"
    };
}
